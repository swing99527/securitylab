# 网络测试平台 - 用户指南

> 汕头人工智能实验室

## 目录

- [一、系统概述](#一系统概述)
- [二、核心实体关系](#二核心实体关系)
- [三、用户角色与权限](#三用户角色与权限)
- [四、完整业务流程](#四完整业务流程)
- [五、各模块操作指南](#五各模块操作指南)
- [六、状态流转说明](#六状态流转说明)
- [七、自动化功能](#七自动化功能)

---

## 一、系统概述

本系统是汕头人工智能实验室开发的网络测试平台，支持从样品入库、项目创建、自动化检测、合规审核到报告签发的完整业务闭环。

### 核心功能模块

| 模块 | 路径 | 功能说明 |
|------|------|---------|
| 综合态势驾驶舱 | `/dashboard` | 实验室运营全局视图、统计指标、待办事项 |
| 项目管理 | `/projects` | 检测项目创建、进度跟踪、合规矩阵 |
| 任务控制台 | `/tasks` | 检测任务配置、执行监控、实时日志 |
| 报告中心 | `/reports` | 报告生成、在线编审、电子签章 |
| 样品库 | `/samples` | 样品入库、流转追踪、二维码管理 |
| 知识库 | `/knowledge` | 标准规范、操作手册、技术文档 |
| 系统设置 | `/settings` | 用户管理、硬件配置、安全设置 |

---

## 二、核心实体关系

### 2.1 实体关系图

\`\`\`
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   ┌──────────┐    1:N    ┌──────────┐    1:N    ┌──────────┐               │
│   │  样品    │ ────────► │  项目    │ ────────► │  任务    │               │
│   │ Sample   │           │ Project  │           │  Task    │               │
│   └──────────┘           └──────────┘           └──────────┘               │
│        │                      │                      │                      │
│        │                      │ 1:N                  │ 1:N                  │
│        │                      ▼                      ▼                      │
│        │                 ┌──────────┐           ┌──────────┐               │
│        │                 │  报告    │ ◄──汇总── │ 漏洞发现 │               │
│        │                 │ Report   │           │ Finding  │               │
│        │                 └──────────┘           └──────────┘               │
│        │                      │                                             │
│        │                      │ 1:1                                         │
│        │                      ▼                                             │
│        │                 ┌──────────┐                                      │
│        └───关联检测────► │ 合规矩阵 │                                      │
│                          │Compliance│                                      │
│                          └──────────┘                                      │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
\`\`\`

### 2.2 关系详解

#### 样品 (Sample) ↔ 项目 (Project)

| 关系类型 | 说明 |
|----------|------|
| **1:N** | 一个样品可关联多个项目（首测、复测、不同标准检测） |
| **N:M** | 一个项目可包含多个样品（主设备 + 配件/子模块） |

\`\`\`
示例：
样品: SPL-2024-0042 (智能门锁主机)
  ├── PRJ-2024-001: EN 18031 认证检测
  ├── PRJ-2024-015: 漏洞修复后复测
  └── PRJ-2024-023: EN 303 645 补充认证
\`\`\`

#### 项目 (Project) → 任务 (Task)

| 关系类型 | 说明 |
|----------|------|
| **1:N** | 一个项目包含多个检测任务，按检测类型划分 |

\`\`\`
示例：
项目: PRJ-2024-001 智能门锁安全检测
  ├── TSK-001: 网络端口扫描 (Nmap)
  ├── TSK-002: 漏洞扫描 (OpenVAS)
  ├── TSK-003: 固件逆向分析 (Binwalk + Ghidra)
  ├── TSK-004: 蓝牙协议模糊测试 (Boofuzz)
  └── TSK-005: Web API 渗透测试 (Burp Suite)
\`\`\`

#### 任务 (Task) → 漏洞发现 (Finding)

| 关系类型 | 说明 |
|----------|------|
| **1:N** | 一个任务执行后产生零到多个漏洞发现 |

\`\`\`
示例：
任务: TSK-002 漏洞扫描
  ├── VUL-001: CVE-2023-1234 命令注入 (Critical)
  ├── VUL-002: 默认弱密码 admin/admin (High)
  ├── VUL-003: TLS 1.0 未禁用 (Medium)
  └── VUL-004: 信息泄露 - 版本号暴露 (Low)
\`\`\`

#### 项目 (Project) → 报告 (Report)

| 关系类型 | 说明 |
|----------|------|
| **1:N** | 一个项目可生成多份报告（版本迭代） |

\`\`\`
示例：
项目: PRJ-2024-001
  ├── RPT-001-v1.0: 初稿 (已驳回 - 缺少截图证据)
  ├── RPT-001-v1.1: 修订版 (审核中)
  └── RPT-001-v2.0: 最终版 (已签章发布)
\`\`\`

#### 项目 (Project) → 合规矩阵 (Compliance)

| 关系类型 | 说明 |
|----------|------|
| **1:1** | 一个项目对应一份合规矩阵（基于所选检测标准） |

\`\`\`
示例：
项目: PRJ-2024-001 (检测标准: EN 18031-1)
  └── 合规矩阵: 共 47 条款
        ├── 3.2.1 安全启动机制 → Pass (自动判定)
        ├── 3.2.2 安全固件更新 → Warning (需人工复核)
        ├── 3.3.1 通信加密 → Fail (未使用 TLS 1.3)
        └── ... (其他条款)
\`\`\`

---

## 三、用户角色与权限

### 3.1 角色定义

| 角色 | 职责描述 |
|------|---------|
| **系统管理员** | 系统配置、用户管理、硬件管理 |
| **实验室主管** | 全局监控、报告终审、电子签章 |
| **项目经理** | 项目创建、资源调度、进度管理 |
| **测试工程师** | 任务执行、漏洞分析、合规填写 |
| **审核员** | 报告审核、批注修订 |
| **样品管理员** | 样品出入库、流转管理 |
| **客户（外部）** | 查看项目进度、下载报告 |

### 3.2 权限矩阵

| 功能模块 | 管理员 | 主管 | 项目经理 | 工程师 | 审核员 | 样品管理员 | 客户 |
|----------|:------:|:----:|:--------:|:------:|:------:|:----------:|:----:|
| 仪表盘 | ✓ | ✓ | ✓ | ✓ | ✓ | - | - |
| 项目管理 | ✓ | ✓ | ✓ | 只读 | - | - | 只读 |
| 任务控制台 | ✓ | ✓ | ✓ | ✓ | - | - | - |
| 合规矩阵 | ✓ | ✓ | ✓ | ✓ | 只读 | - | - |
| 报告编审 | ✓ | ✓ | 只读 | 编辑 | ✓ | - | 下载 |
| 样品库 | ✓ | ✓ | 只读 | 只读 | - | ✓ | - |
| 系统设置 | ✓ | - | - | - | - | - | - |

---

## 四、完整业务流程

### 4.1 主流程图

\`\`\`
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐      │
│  │ 1.样品  │   │ 2.创建  │   │ 3.创建  │   │ 4.自动化│   │ 5.合规  │      │
│  │   入库  │ → │   项目  │ → │   任务  │ → │   执行  │ → │   审核  │      │
│  └─────────┘   └─────────┘   └─────────┘   └─────────┘   └─────────┘      │
│       │                                                        │            │
│       │                                                        ▼            │
│       │        ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐      │
│       │        │ 9.样品  │   │ 8.报告  │   │ 7.电子  │   │ 6.报告  │      │
│       └──────► │   归还  │ ← │   交付  │ ← │   签章  │ ← │   编审  │      │
│                └─────────┘   └─────────┘   └─────────┘   └─────────┘      │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
\`\`\`

### 4.2 详细步骤说明

#### 步骤 1: 样品入库

- **操作角色**: 样品管理员
- **入口路径**: \`/samples\` → 点击「样品入库」
- **操作流程**:
  1. 选择入库方式：手动录入 / 扫码入库
  2. 填写样品信息：
     - 基本信息：名称、型号、序列号
     - 厂商信息：厂商名称、固件版本
     - 物理属性：尺寸、重量、配件清单
  3. 上传样品照片（正面、背面、铭牌）
  4. 系统自动生成追踪二维码
  5. 打印二维码标签并粘贴
  6. 确认入库，样品状态变为「在库」

#### 步骤 2: 创建项目

- **操作角色**: 项目经理
- **入口路径**: \`/projects\` → 点击「新建项目」
- **操作流程**:
  1. 填写项目基本信息：
     - 项目名称、项目编号（自动生成）
     - 客户名称、联系方式
     - 检测标准（EN 18031 / ETSI EN 303 645 / 等保2.0）
  2. 关联样品：从样品库选择已入库样品
  3. 配置项目参数：
     - 检测范围、检测深度
     - 预计开始/完成日期
  4. 指派项目成员：
     - 项目负责人
     - 测试工程师（可多人）
     - 审核员、签字人
  5. 提交创建，项目状态变为「待启动」

#### 步骤 3: 创建检测任务

- **操作角色**: 测试工程师
- **入口路径**: \`/tasks\` → 点击「新建任务」
- **操作流程**:
  1. 选择关联项目
  2. 选择任务类型：
     - 网络扫描：配置目标 IP、端口范围
     - 漏洞扫描：选择扫描模板、CVE 数据库版本
     - 固件分析：上传固件文件、选择分析深度
     - 模糊测试：配置协议类型、超时参数、变异策略
     - 渗透测试：配置测试范围、攻击向量
  3. 选择测试引擎：
     - Nmap / Masscan（端口扫描）
     - OpenVAS / Nessus（漏洞扫描）
     - Binwalk / Ghidra（固件分析）
     - Boofuzz / AFL（模糊测试）
  4. 设置优先级和预计时长
  5. 提交任务，进入执行队列

#### 步骤 4: 自动化执行

- **操作角色**: 测试工程师（监控）
- **入口路径**: \`/tasks/[id]\` (Cockpit 控制台)
- **操作流程**:
  1. 任务自动开始执行（或手动启动）
  2. 实时监控界面：
     - **左侧资源树**: 固件解包结构、网络节点发现
     - **中间监控区**:
       - 网络拓扑图：测试仪与 DUT 连接状态
       - Fuzzing 图表：响应时间、崩溃检测
       - 进度条：各阶段完成百分比
     - **右侧统计面板**: 已扫描项、发现漏洞数
     - **底部终端**: 实时日志输出
  3. 支持操作：
     - 暂停/恢复执行
     - 终止任务
     - 导出中间结果
  4. 任务完成后自动汇总漏洞发现

#### 步骤 5: 合规审核

- **操作角色**: 测试工程师 + 技术主管
- **入口路径**: \`/projects/[id]/compliance\`
- **操作流程**:
  1. 进入合规矩阵视图
  2. 系统根据检测结果自动填充「自动判定」列
  3. 逐条审核：
     - **Pass (绿色)**: 可批量确认通过
     - **Warning (黄色)**: 需人工复核，补充证据
     - **Fail (红色)**: 填写失败原因和修复建议
  4. 点击条款行，右侧抽屉显示：
     - 原始检测日志
     - 截图证据
     - 关联漏洞发现
  5. 上传补充证据（截图、日志文件）
  6. 提交合规审核结果

#### 步骤 6: 报告生成与编审

- **操作角色**: 测试工程师 → 审核员
- **入口路径**: \`/reports/[id]\`
- **操作流程**:
  1. 系统自动生成报告草稿（基于模板）
  2. 报告内容结构：
     - 封面：项目信息、客户信息、报告编号
     - 检测概述：范围、方法、环境
     - 漏洞汇总：按严重程度分类统计
     - 详细发现：每个漏洞的描述、复现步骤、修复建议
     - 合规结果：各条款判定结果
     - 附件：原始日志、截图证据
  3. 三栏编审界面：
     - **左栏**: 章节目录导航
     - **中栏**: PDF 实时预览
     - **右栏**: 批注面板
  4. 审核员操作：
     - 在文档上标记问题区域
     - 添加批注（如"截图不清晰，请重新截取"）
     - 工程师回复批注并修改
  5. 审核决策：
     - **驳回修改**: 填写原因，退回工程师
     - **通过审核**: 进入签章流程

#### 步骤 7: 电子签章

- **操作角色**: 签字人（实验室主管/授权代表）
- **入口路径**: \`/reports/[id]\` → 点击「电子签章」
- **操作流程**:
  1. 确认报告最终版本无误
  2. 二次身份验证：
     - 输入签章密码
     - 或插入 UKey 进行验证
  3. 选择签章位置（预设位置）
  4. 确认签章，报告状态变为「已签章」
  5. 系统生成带数字签名的 PDF

#### 步骤 8: 报告交付

- **操作角色**: 项目经理 / 客户
- **操作流程**:
  1. 报告签章完成后，状态变为「已完成」
  2. 系统自动通知客户（邮件/短信）
  3. 客户通过「客户门户」：
     - 查看项目最终状态
     - 下载签章报告 (PDF)
     - 查看检测摘要
  4. 项目经理归档项目

#### 步骤 9: 样品归还

- **操作角色**: 样品管理员
- **入口路径**: \`/samples/[id]\` → 点击「归还」
- **操作流程**:
  1. 扫描样品二维码确认身份
  2. 检查样品完整性
  3. 填写归还信息：
     - 归还日期
     - 经手人
     - 备注（如有损坏说明）
  4. 确认归还，样品状态变为「已归还」
  5. 通知客户取回样品

---

## 五、各模块操作指南

### 5.1 仪表盘 (\`/dashboard\`)

**功能说明**: 实验室运营全局视图

**主要组件**:
- 统计卡片：进行中项目、待处理任务、本月漏洞、待审报告
- 实验室负荷热力图：按时间段显示设备占用情况
- 漏洞趋势图：堆叠面积图显示各等级漏洞发现趋势
- 待办事项列表：个人待处理任务

### 5.2 任务控制台 Cockpit (\`/tasks/[id]\`)

**功能说明**: 检测任务实时监控与控制

**界面布局**:
\`\`\`
┌─────────────────────────────────────────────────────────────┐
│                    进度条 (分阶段显示)                       │
├───────────┬─────────────────────────────┬───────────────────┤
│           │                             │                   │
│  资源树   │      网络拓扑 / Fuzzing     │    实时统计       │
│  (可展开) │         监控图表            │    漏洞列表       │
│           │                             │                   │
├───────────┴─────────────────────────────┴───────────────────┤
│                      实时终端日志                            │
│  [暂停滚动] [搜索] [清屏] [下载日志]                        │
└─────────────────────────────────────────────────────────────┘
\`\`\`

**快捷操作**:
- \`Ctrl + P\`: 暂停/恢复执行
- \`Ctrl + F\`: 搜索日志
- \`Ctrl + L\`: 清屏
- \`Ctrl + S\`: 导出当前结果

### 5.3 合规矩阵 (\`/projects/[id]/compliance\`)

**功能说明**: EN 18031 等标准的逐条合规判定

**表格列定义**:
| 列名 | 说明 |
|------|------|
| 条款号 | 标准章节编号（支持树形展开） |
| 要求描述 | 合规条款的具体内容 |
| 关联测试项 | 映射到的检测任务/用例 |
| 自动判定 | 系统根据测试结果自动填充 |
| 人工复核 | 工程师手动确认结果 |
| 证据 | 支撑判定的日志/截图 |

**批量操作**:
- 一键通过所有绿色项
- 批量导出待复核项
- 批量上传证据

### 5.4 报告编审 (\`/reports/[id]\`)

**功能说明**: 报告在线预览、批注、审核

**三栏布局**:
- **左栏 (20%)**: 报告目录树，点击跳转
- **中栏 (50%)**: PDF 预览，支持缩放、翻页
- **右栏 (30%)**: 批注列表，支持回复、标记已解决

**审核流程**:
\`\`\`
草稿 → [提交审核] → 审核中 → [通过] → 待签章 → [签章] → 已完成
                         ↓
                      [驳回] → 修改中 → [重新提交]
\`\`\`

---

## 六、状态流转说明

### 6.1 样品状态

\`\`\`
┌─────────┐    入库    ┌─────────┐   领用    ┌─────────┐
│ 待入库  │ ────────► │  在库   │ ────────► │ 检测中  │
└─────────┘           └─────────┘           └─────────┘
                           ▲                     │
                           │ 归还                │ 完成
                           │                     ▼
                      ┌─────────┐           ┌─────────┐
                      │ 已归还  │ ◄──────── │ 待归还  │
                      └─────────┘           └─────────┘
\`\`\`

### 6.2 项目状态

\`\`\`
┌─────────┐   启动    ┌─────────┐   提交    ┌─────────┐
│ 待启动  │ ────────► │ 进行中  │ ────────► │ 审核中  │
└─────────┘           └─────────┘           └─────────┘
                                                 │
                      ┌─────────┐   归档    ┌────┴────┐
                      │ 已归档  │ ◄──────── │ 已完成  │
                      └─────────┘           └─────────┘
\`\`\`

### 6.3 任务状态

\`\`\`
┌─────────┐   开始    ┌─────────┐   完成    ┌─────────┐
│ 待执行  │ ────────► │ 执行中  │ ────────► │ 已完成  │
└─────────┘           └─────────┘           └─────────┘
                           │
                      暂停 │ ▲ 恢复
                           ▼ │
                      ┌─────────┐
                      │ 已暂停  │
                      └─────────┘
                           │
                      终止 ▼
                      ┌─────────┐
                      │  失败   │
                      └─────────┘
\`\`\`

### 6.4 报告状态

\`\`\`
┌─────────┐   提交    ┌─────────┐   通过    ┌─────────┐   签章    ┌─────────┐
│  草稿   │ ────────► │ 审核中  │ ────────► │ 待签章  │ ────────► │ 已签章  │
└─────────┘           └─────────┘           └─────────┘           └─────────┘
     ▲                     │
     │                驳回 │
     │                     ▼
     │                ┌─────────┐
     └─────修改────── │ 已驳回  │
                      └─────────┘
\`\`\`

---

## 七、自动化功能

### 7.1 实时通信

| 功能 | 技术实现 | 说明 |
|------|---------|------|
| 任务进度推送 | WebSocket | 扫描进度实时更新到前端 |
| 硬件状态监控 | WebSocket | 设备在线/离线状态变更通知 |
| 通知推送 | WebSocket + 消息队列 | 审核结果、任务完成等事件通知 |

### 7.2 自动判定逻辑

系统根据测试结果自动填充合规矩阵：

\`\`\`javascript
// 判定逻辑示例
if (testResult.vulnerabilities.critical > 0) {
  compliance.status = 'fail';
} else if (testResult.vulnerabilities.high > 0) {
  compliance.status = 'warning';
} else if (testResult.coverage >= 100) {
  compliance.status = 'pass';
} else {
  compliance.status = 'pending'; // 需人工复核
}
\`\`\`

### 7.3 报告自动生成

报告基于模板自动填充以下内容：
- 项目基本信息（从项目表读取）
- 检测环境配置（从任务配置读取）
- 漏洞发现列表（从任务结果汇总）
- 合规判定结果（从合规矩阵读取）
- 统计图表（自动生成）

### 7.4 二维码追踪

样品全生命周期通过二维码追踪：

\`\`\`
二维码内容: SPL-2024-0042
  │
  ├── 扫码入库 → 记录入库时间、操作人
  ├── 扫码领用 → 记录领用时间、领用人、关联项目
  ├── 扫码归还 → 记录归还时间、经手人
  └── 扫码查询 → 显示样品完整流转历史
\`\`\`

---

## 附录

### A. 快捷键一览

| 快捷键 | 功能 | 适用页面 |
|--------|------|---------|
| \`Ctrl + N\` | 新建 | 全局 |
| \`Ctrl + S\` | 保存 | 表单页面 |
| \`Ctrl + F\` | 搜索 | 列表/终端 |
| \`Ctrl + P\` | 暂停/恢复 | 任务控制台 |
| \`Ctrl + L\` | 清屏 | 终端 |
| \`Esc\` | 关闭弹窗/抽屉 | 全局 |

### B. 支持的检测标准

- EN 18031-1/2/3 (欧盟无线电设备网络安全)
- ETSI EN 303 645 (消费类 IoT 安全)
- IEC 62443 (工业自动化安全)
- 等保 2.0 (中国网络安全等级保护)
- ISO 27001 (信息安全管理)

### C. 支持的测试引擎

| 类型 | 引擎 |
|------|------|
| 端口扫描 | Nmap, Masscan |
| 漏洞扫描 | OpenVAS, Nessus, Qualys |
| 固件分析 | Binwalk, Ghidra, IDA Pro |
| 模糊测试 | Boofuzz, AFL, libFuzzer |
| Web 渗透 | Burp Suite, OWASP ZAP |
| 无线测试 | Aircrack-ng, Kismet |

---

*文档版本: 1.0*
*最后更新: 2024年12月*
*汕头人工智能实验室*
